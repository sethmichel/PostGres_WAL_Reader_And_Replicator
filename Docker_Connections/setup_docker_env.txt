1) get docker compose & make a env file for each container, and a yml file for docker

2) in the docker folder with the env and yml files: docker compose up -d

3) go to localhost:8080 and login

4) should have servers: primary, standby

5) enable logical replication
    in primary: CREATE PUBLICATION <publisher name> FOR ALL TABLES;
    Then do this to see the publication: SELECT * FROM pg_publication;
        this makes a publication on the primary server. it's a logical replication stream called <name> which includes every table in the db


    in standby: CREATE SUBSCRIPTION <subscription name> CONNECTION 'host= port= user= password= dbname=' PUBLICATION <publisher name>;

    now we should see some results from: SELECT * FROM pg_stat_replication;

6) check wal2json is installed correctly. in primary psql run: SELECT * FROM pg_create_logical_replication_slot('test_slot', 'wal2json');
    the actual pg functions to check plugins was removed in pg 16, you have to do it this way


misc commands
list running containers           docker ps

enter a containers shell          docker exec -it <primary host name> bash

start psql only if username and   psql -U <username>
db name are the same  

start psql only if username and   psql -U <username> -d <db name>
db name are different

now we'll see "<username>=#"
if we see "<username>-#" it means it's waiting for you to finish a multi line query. so you probably forgot the ";"
                                
quit                        \q
switch db's                 \c <db name>
exit root                   exit

This is where pg writes WAL (shared memory (buffer))  pg_waldump /var/lib/postgresql/data/pg_wal




note about how the ports work
- the yml files have host_port (localhost):container_port. so 5434:5432 means
        pg inside the container runs on 5432, docker forwards localhost:5434 on my machine to port 5432 in the container
  the env files port should be what the containers use. the pg servers should use 5432 when I make them